% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/search.R
\name{nva_search_aggregations}
\alias{nva_search_aggregations}
\title{Get aggregations (facet counts) for an NVA search}
\usage{
nva_search_aggregations(
  query,
  limit = 10L,
  offset = 0L,
  sort = c("relevance", "modifiedDate", "createdDate", "publishedDate", "title",
    "category", "publicationDate", "unitId"),
  organization = NULL,
  year = NULL,
  type = NULL,
  contributor = NULL,
  contributor_name = NULL,
  doi = NULL,
  title = NULL,
  abstract = NULL,
  tags = NULL,
  journal = NULL,
  publisher = NULL,
  issn = NULL,
  isbn = NULL,
  license = NULL,
  files = NULL,
  funding_source = NULL,
  funding_identifier = NULL,
  scientific_value = NULL,
  scientific_index_status = NULL,
  created_since = NULL,
  modified_since = NULL,
  published_since = NULL,
  status = NULL,
  orcid = NULL,
  project = NULL,
  unit = NULL,
  ...
)
}
\arguments{
\item{query}{Search query string}

\item{limit}{Number of results to return per page (default: 10, max: 100)}

\item{offset}{Offset for pagination (default: 0)}

\item{sort}{Sort order. One of "relevance" (default), "modifiedDate",
"createdDate", "publishedDate", "title", "category", "publicationDate",
or "unitId"}

\item{organization}{Filter by organization Cristin ID (e.g., "185" for UiO)}

\item{year}{Filter by publication year. Supports single year (e.g., 2024) or
range as comma-separated values (e.g., "2020,2024" for years 2020-2024)}

\item{type}{Filter by publication type (e.g., "AcademicArticle")}

\item{contributor}{Filter by Cristin person ID}

\item{contributor_name}{Filter by contributor name (fuzzy match)}

\item{doi}{Filter by DOI}

\item{title}{Filter by title text}

\item{abstract}{Filter by abstract text}

\item{tags}{Filter by tags/keywords}

\item{journal}{Filter by journal name, ID, or ISSN}

\item{publisher}{Filter by publisher name or ID}

\item{issn}{Filter by ISSN}

\item{isbn}{Filter by ISBN}

\item{license}{Filter by license}

\item{files}{Filter by file status (e.g., "hasPublicFiles")}

\item{funding_source}{Filter by funding source text}

\item{funding_identifier}{Filter by funding project ID}

\item{scientific_value}{Filter by NPI level ("LevelOne", "LevelTwo")}

\item{scientific_index_status}{Filter by reporting status}

\item{created_since}{Filter by creation date (ISO 8601)}

\item{modified_since}{Filter by modification date (ISO 8601)}

\item{published_since}{Filter by publication date (ISO 8601)}

\item{status}{Filter by publication status}

\item{orcid}{Filter by ORCID}

\item{project}{Filter by Cristin project ID}

\item{unit}{Filter by organizational unit ID}

\item{...}{Additional API query parameters passed directly (see
\href{https://github.com/BIBSYSDEV/nva-search-api}{NVA Search API docs})}
}
\value{
A tibble with columns:
\describe{
\item{aggregation}{Aggregation field name (e.g., "type", "topLevelOrganization")}
\item{key}{Bucket key (identifier or value)}
\item{label}{Human-readable label (English preferred, falls back to Norwegian)}
\item{count}{Number of matching publications}
}
}
\description{
Returns facet counts for a search query, showing how results are distributed
across categories like publication type, institution, year, etc. Accepts the
same filter parameters as \code{\link[=nva_search]{nva_search()}}.
}
\details{
The API returns up to 100 buckets per aggregation field. Fields with fewer
natural categories (e.g., "type", "files", "license") return all values,
while high-cardinality fields (e.g., "contributor", "journal",
"topLevelOrganization") are capped at the top 100 by count. To get more
granular breakdowns, narrow your search with filters.

Available aggregation fields: \code{type}, \code{topLevelOrganization}, \code{contributor},
\code{journal}, \code{series}, \code{publisher}, \code{fundingSource}, \code{scientificIndex},
\code{license}, \code{files}.
}
\examples{
\dontrun{
# See how "climate" results break down by type and institution
nva_search_aggregations("climate")

# Filter to just publication type counts
nva_search_aggregations("climate") |>
  dplyr::filter(aggregation == "type")

# Aggregations for a filtered search
nva_search_aggregations("machine learning", year = 2024, organization = "185")
}
}
\seealso{
\code{\link[=nva_search]{nva_search()}} for retrieving the publications themselves
}
